# ðŸŒ‰ ModelOp Bridge: Azure Copilot Governance Connector

### *Turn on the lights in your "Shadow AI" basement.*

Welcome! Youâ€™ve likely arrived here because your organization just deployed **Microsoft 365 Copilot** or **Azure OpenAI**. Itâ€™s exciting! "Citizen Developers" in HR, Finance, and Legal are building bots faster than you can track them.

**But hereâ€™s the nagging question:** &gt; *Do you actually know what those bots are saying?*

This tool is your **Flashlight**. It is a specialized ETL (Extract, Transform, Load) bridge designed to:

1. **CONNECT** to your Microsoft Azure Tenant to pull real chat history.
2. **SIMULATE** realistic traffic (if you don't have real users yet).
3. **RED TEAM** your AI by injecting adversarial attacks and PII leaks.
4. **DELIVER** clean, standardized data to **ModelOp Center** for governance.

### ðŸ“Š How It Works: The Logic Engine

When you feed data into ModelOp Center (whether real or simulated), it immediately passes through our OOTB Standardized Monitors. This diagram shows exactly which "lights" turn on based on the data you generate with this tool.

### ðŸ“‚ Repository Structure

*What's inside the box?*

    .
    â”œâ”€â”€ azure_moc_connector.py     # ðŸ§  Connects to Azure, Simulates AI, and Red Teams.
    â”œâ”€â”€ generate_demo_data.py      # ðŸŽ­ Automates creation of "Phase 1 Lite" demo scenarios.
    â”œâ”€â”€ config.yaml                # âš™ï¸ Configure simulation rates, Azure creds, and Red Team settings.
    â”œâ”€â”€ mock_expansion_data.json   # ðŸŽ¨ Example JSON used by the AI to learn your corporate "Voice".
    â”œâ”€â”€ roadmap.md                 # ðŸ—ºï¸ Architecture diagrams and development checklist.
    â”œâ”€â”€ partner_welcome.md         # ðŸ¤ Executive summary and value proposition for partners.
    â”œâ”€â”€ requirements.txt           # ðŸ“¦ Python libraries needed to run the tools.
    â”œâ”€â”€ llm_data_monitoring_diagram.png # ðŸ“Š Source image for the monitoring logic flow.
    â””â”€â”€ generated_chats/           # ðŸ“¤ Where your raw JSON logs appear.
        â”œâ”€â”€ baseline_data.json     #    -> The "Control" (Clean Data)
        â””â”€â”€ comparator_data.json   #    -> The "Variable" (Risk Data)
    â””â”€â”€ phase_1_lite_demo/         # ðŸ’Ž Pre-packaged "Story Mode" datasets generated by the demo script.


### â˜• The "Coffee Break" Factor

**Read this first!** Running Local AI (Ollama) on a laptop is hard work.

- **Speed:** Expect ~1-3 minutes per conversation.
- **Total Time:** A full run (25 records) might take **45 minutes**.
- **Pro Tip:** Start the script, grab a coffee, and let it do the heavy lifting in the background.

### âš ï¸ Important: Python Version Compatibility

- **ModelOp Center Runtime:** Currently runs on **Python 3.8**, upgrading to **Python 3.9** in the next release (version 3.4).
- **Your Local Machine:** Likely runs Python **3.11** or **3.12**.

To prevent "It works on my machine" issues and ensure compatibility with the provided `requirements.txt`, we strongly recommend using **Python 3.8** for this project. Newer versions (especially 3.13+) may cause dependency conflicts with libraries like `spacy`.

### ðŸ Part 1: New User Setup Guide (Windows/VS Code)

*Follow these steps exactly if you are setting this up for the first time.*

#### 1. Install Python 3.8 & Git (The Fast Way)

Open your **PowerShell** or **Command Prompt** and paste this command to install everything instantly. This installs Python 3.8 to match the ModelOp runtime environment.

    winget install -e --id Python.Python.3.8
    winget install -e --id Git.Git

*Restart your computer after this finishes.*

#### 2. Clone the Repo in VS Code

1. Open **VS Code**.
2. Go to **File &gt; New Window** (to ensure a clean slate).
3. On the "Welcome" screen, click **"Clone Git Repository..."**.
4. Paste the URL: `https://github.com/s-neub/azure_moc_connector`
5. Select a folder (e.g., `Documents`) to save it.
6. **Crucial Step:** When asked *"Would you like to open the cloned repository?"*, click **Open**.

#### 3. The "One-Command" Environment Setup

Open the VS Code Terminal (`Ctrl + ~`) and paste this block. It creates the virtual environment (`venv`) using your installed Python, updates setup tools, and installs dependencies automatically.

**For Windows (PowerShell):**

    py -3.8 -m venv venv; .\venv\Scripts\activate; python -m pip install --upgrade pip setuptools wheel; pip install -r requirements.txt; python -m spacy download en_core_web_sm

**For Mac/Linux:**

    python3.8 -m venv venv && source venv/bin/activate && pip install --upgrade pip setuptools wheel && pip install -r requirements.txt && python -m spacy download en_core_web_sm

### ðŸ› ï¸ Part 2: Get the "Brains" (Ollama)

*Skip this if you are strictly connecting to Real Azure (Phase 3), but we recommend it for the Red Teaming features!*

1. **Download It:** Go to [ollama.com](https://ollama.com "null") and install it.
2. **Get the Model:** Open your terminal and type:

        ollama pull qwen2.5

### âš™ï¸ Part 3: Choose Your Adventure (Configuration)

This script supports three distinct testing phases. Open `config.yaml` to choose your path.

#### ðŸŸ¢ Phase 1: The "Mock" - "Kick the Tires" (Fastest)

*Goal: I want to see the dashboard light up NOW without waiting for data generation.*

1. **Run the Storyteller:** Execute `python generate_demo_data.py`.
2. **Open the Gift Shop:** Navigate to the `phase_1_lite_demo/` folder.
3. **Upload:** Drag and drop the pre-cooked JSON files into ModelOp (Baseline first, then Day 1 -&gt; Day 3) to tell a specific risk story immediately.

#### ðŸŸ¡ Phase 2: Custom Simulation (Best for Demos)

*Goal: Test specific scenarios (e.g., "What if my bot is rude?") and prove ModelOp catches bad guys.*

1. **Configure `config.yaml`:**

    - **Mode:** Set `use_real_azure: false`.
    - **Rates:** Adjust `rates` (e.g., increase `toxicity` to 0.5 to see more red alerts).
    - **Red Teaming:** Set `simulation > red_teaming > adversarial_injection > active: true`.
2. **Run the script:** `python azure_moc_connector.py`.
3. **Upload:** Use the new `comparator_data.json` to see how the monitors react.

#### ðŸ”´ Phase 3: The "Real World" (The Holy Grail)

*Goal: Connect to your actual Microsoft 365 Copilot to audit real user interactions.*

1. **Configure `config.yaml`:**

    - **Connect:** Set `use_real_azure: true` and fill in your `azure` credentials.
2. **The Pipeline:** Run `python azure_moc_connector.py`.
3. **Upload:** Upload the resulting audit log to ModelOp.

### ðŸš€ Run It!

    python azure_moc_connector.py

**What you'll see:**

- A progress bar tracking the generation of "Safe" chats.
- A second bar tracking the injection of "Adversarial" attacks.
- A final report showing where your files are saved (`generated_chats/`).

### â“ Troubleshooting Guide

*Stuck? Follow these steps in order to fix common setup issues.*

#### 1. "SecurityError: Running scripts is disabled on this system"

- **The Context:** You tried to run the setup command, but PowerShell blocked the activation script.
- **The Fix:** Run this command in your VS Code terminal to allow scripts for this session only:

        Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process

    Then try the setup command again.

#### 2. Error: `SyntaxError: invalid syntax` (&gt;&gt;&gt;)

- **The Context:** You see `>>>` at the start of your line. This means you are inside the **Python Interpreter**, not the system terminal.
- **The Fix:** Type `exit()` and press Enter. Your prompt should return to a path like `C:\Users\Name>`. Now run your commands.

#### 3. "A workspace is required..." or VS Code can't find 'venv'

- **The Context:** You opened a single file instead of the folder. VS Code needs the folder to find the configuration.
- **The Fix:** Go to **File &gt; Open Folder...** and select the `azure_moc_connector` folder.
- **Check Interpreter:** Press `Ctrl+Shift+P`, type **"Python: Select Interpreter"**, and ensure `('venv': venv)` is selected.

#### 4. "Microsoft Visual C++ 14.0 is required" / Build Failures

- **The Context:** `pip` is trying to compile `spacy` from source because it can't find a pre-built file for your Python version.
- **The Fix:**

    1. Ensure you updated `pip` (included in the setup command above).
    2. **Check Python Version:** Run `python --version`. If it says 3.13+ or something other than 3.8/3.9, try installing **Python 3.8** (Step 1) and recreating your environment using `py -3.8 -m venv venv`.

#### 5. "I don't see 'Clone Git Repository' option"

- **The Context:** Git is not installed on your machine.
- **The Fix:** Run `winget install -e --id Git.Git` in PowerShell and restart VS Code.

#### 6. File Permission Errors ("Access Denied")

- **The Context:** OneDrive or Google Drive is actively syncing the file you are trying to write.
- **The Fix:** Pause syncing on OneDrive/Google Drive for 1 hour while you run the setup.

### ðŸ“¤ Final Step: Upload to ModelOp

1. Grab the `modelop_llm_data_YYYYMMDD.json` file from the output folder.
2. Log into **ModelOp Center**.
3. Navigate to your **LLM Use Case**.
4. Upload as **Comparator Data**.
5. *Watch the magic happen.* ðŸª„